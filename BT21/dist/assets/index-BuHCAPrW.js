(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const c=document.getElementById("formAdd"),D=document.getElementById("addStudent"),C=document.getElementById("submit"),q=document.getElementById("textHeading");let v=!1,r=[];const m=10;let a=1;const $=document.getElementById("listPage"),O=document.getElementById("pages");function g(){a===1?(document.getElementById("prev").setAttribute("disabled",!0),document.getElementById("prev").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("prev").removeAttribute("disabled"),document.getElementById("prev").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.remove("bg-gray-300","text-gray-500"));let e=0;u===!0?e=Math.ceil(d.length/m):e=Math.ceil(r.length/m),a===e?(document.getElementById("next").setAttribute("disabled",!0),document.getElementById("next").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("next").removeAttribute("disabled"),document.getElementById("next").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.remove("bg-gray-300","text-gray-500"))}document.getElementById("prev").addEventListener("click",function(){a>1&&(a--,i(u===!0?d:r,a),document.querySelectorAll(".page").forEach(function(e){e.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),e.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${a}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${a}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&E(b))});document.getElementById("next").addEventListener("click",function(){let e=0;u===!0?e=Math.ceil(d.length/m):e=Math.ceil(r.length/m),a<e&&(a++,i(u===!0?d:r,a),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${a}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${a}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&E(b))});O.addEventListener("click",function(e){e.target.classList.contains("page")&&(a=parseInt(e.target.dataset.page),i(u===!0?d:r,a),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),e.target.classList.add("bg-blue-500","text-white","hover:bg-blue-700"),e.target.classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&E(b))});function P(e,t,n){const l=(n-1)*t,o=l+t;return e.slice(l,o)}function f(e,t){const n=Math.ceil(e.length/t);let l="";for(let o=1;o<=n;o++)l+=`<button class="page ${o===1?"bg-blue-500 hover:bg-blue-700 nfont-bold text-white":"bg-gray-300 hover:bg-gray-500 text-black"}  font-bold py-2 px-4 rounded" data-page="${o}">${o}</button>`;$.innerHTML=l}function i(e,t=1){let n=document.getElementById("listStudent"),l="";P(e,m,t).forEach(function(s){l+='<tr><td class="border border-gray-300 px-4 py-2">'+s.name+'</td><td class="border border-gray-300 px-4 py-2">'+s.MSSV+'</td><td class="border border-gray-300 px-4 py-2">'+s.email+'</td><td class="border border-gray-300 px-4 py-2">'+s.department.text+'</td><td class="border border-gray-300 px-4 py-2">'+s.gender.text+'</td><td class="border border-gray-300 px-4 py-2">'+s.birthdate+`</td><td class="border border-gray-300 px-4 py-2 text-center"><button class="editStudent bg-blue-500 hover:bg-blue-700 active:bg-blue-900 text-white font-bold py-2 px-4 rounded" data-mssv="${s.MSSV}">Sửa</button></td><td class="border border-gray-300 px-4 py-2"><button class="delStudent  bg-red-500 hover:bg-red-700 active:bg-red-900 text-white font-bold py-2 px-4 rounded" data-mssv="${s.MSSV}">Xóa</button></td></tr>`}),n.innerHTML=l}D.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="flex",C.textContent="Thêm",q.textContent="Thêm Sinh Viên",document.getElementById("MSSV").removeAttribute("readonly"),document.getElementById("MSSV").style.backgroundColor="white"});const h=document.getElementById("deleteModal"),N=document.getElementById("deleteBtn"),H=document.querySelector(".closeModalConfirm"),Y=document.getElementById("huyBtn");N.addEventListener("click",function(){r=r.filter(e=>e.MSSV!==h.dataset.mssv),B(),h.style.display="none",u=!1,d=[],y.reset(),i(r),f(r,m),g(),E(b)});Y.addEventListener("click",function(){h.style.display="none"});H.addEventListener("click",function(){h.style.display="none"});document.addEventListener("click",function(e){if(e.target.classList.contains("delStudent"))h.style.display="flex",h.dataset.mssv=e.target.dataset.mssv;else if(e.target.classList.contains("editStudent")){const t=e.target.dataset.mssv,n=r.find(l=>l.MSSV===t);if(n){const l=document.getElementById("themsv");l.style.display="flex",C.textContent="Cập nhật",q.textContent="Cập nhật Thông tin",document.getElementById("name").value=n.name,document.getElementById("MSSV").value=n.MSSV,document.getElementById("MSSV").setAttribute("readonly",!0),document.getElementById("MSSV").style.backgroundColor="#C0C0C0",document.getElementById("email").value=n.email,document.getElementById("department").value=n.department.value,document.getElementById("gender").value=n.gender.value,document.getElementById("birthdate").value=n.birthdate,v=!0}}});let S=null;c.addEventListener("submit",function(e){e.preventDefault();let t={name:c.name.value.trim(),MSSV:c.MSSV.value.trim(),email:c.email.value.trim(),department:{value:c.department.value,text:c.department.options[c.department.selectedIndex].text},gender:{value:c.gender.value,text:c.gender.options[c.gender.selectedIndex].text},birthdate:c.birthdate.value};if(v===!1){for(let l=0;l<r.length;l++)if(r[l].MSSV===t.MSSV){alert("MSSV đã tồn tại");return}r.push(t),B(),u=!1,d=[],y.reset(),i(r),f(r,m),g(),c.reset()}else S=t,I.style.display="flex";const n=document.getElementById("themsv");n.style.display="none",console.log(t)});const F=document.getElementById("search"),J=document.getElementById("searchBtn"),T=document.getElementById("clearSearch");T.addEventListener("click",function(){F.value="",u=!1,i(r),f(r,m),g()});J.addEventListener("click",function(){const e=F.value;if(e==="")u=!1,i(r),f(r,m),g();else{u=!0,d=r.filter(n=>n.name.toLowerCase().includes(e.toLowerCase()));let t=document.getElementById("listStudent");if(i(d),f(d,m),g(),d.length===0){let n='<tr><td class="border border-gray-300 px-4 py-2" colspan="8">Không tìm thấy sinh viên</td></tr>';t.innerHTML=n}}});function K(){let e=new Date().getFullYear(),t=document.getElementById("yearFilter");for(let n=e;n>=1980;n--){let l=document.createElement("option");l.value=n,l.text=n,t.appendChild(l)}}K();const j=document.getElementById("closeModal");j.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="none",v=!1,c.reset()});const U=document.getElementById("closefil");U.addEventListener("click",function(){const e=document.getElementById("locsv");e.style.display="none"});const X=document.getElementById("filStudent");X.addEventListener("click",function(){T.click();const e=document.getElementById("locsv"),t=y.yearFilter.value,n=y.gFilter.value,l=y.dFilter.value;i(t!==""||n!==""||l!==""?d:r),e.style.display="flex"});const y=document.getElementById("formFilter");let u=!1,d=[];y.addEventListener("submit",function(e){e.preventDefault();const t=y.yearFilter.value,n=y.gFilter.value,l=y.dFilter.value;d=r,u=!0,t!==""&&(d=d.filter(s=>s.birthdate.includes(t))),n!==""&&(d=d.filter(s=>s.gender.value===n)),l!==""&&(d=d.filter(s=>s.department.value===l)),i(d),f(d,m),a=1,g();const o=document.getElementById("locsv");o.style.display="none"});y.addEventListener("reset",function(){u=!1,i(r),f(r,m),a=1,g(),y.reset();const e=document.getElementById("locsv");e.style.display="none"});function L(e,t,n=!0){e.sort((l,o)=>{const s=M(l,t),p=M(o,t);return n?s.localeCompare(p):p.localeCompare(s)})}const x=document.getElementById("table");function M(e,t){switch(t){case 0:return e.name.trim();case 1:return e.MSSV.trim();case 2:return e.email.trim();case 3:return e.department.text.trim();case 4:return e.gender.text.trim();case 5:return e.birthdate.trim();default:return""}}let b=-1;function E(e){const t=document.getElementById("table"),n=Array.from(t.querySelectorAll("tr"));t.querySelectorAll("th").forEach(l=>{l.classList.remove("bg-blue-200")}),n.forEach(l=>{l.querySelectorAll("td").forEach(o=>{o.classList.remove("bg-blue-100")})}),t.querySelectorAll("th")[e].classList.add("bg-blue-200"),n.forEach(l=>{const o=l.querySelectorAll("td")[e];o&&o.classList.add("bg-blue-100")}),b=e}x.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{E(t)})});x.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{x.querySelectorAll(".ths").forEach(o=>{if(o!==e){o.classList.remove("asc");const s=o.querySelector("svg");s.style.transform="rotate(0deg)"}});const n=e.classList.contains("asc");L(u===!0?d:r,t,!n),i(u?d:r,1),f(u?d:r,m),a=1,g(),E(t),e.classList.toggle("asc",!n);const l=e.querySelector("svg");n?l.style.transform="rotate(180deg)":l.style.transform="rotate(0deg)"})});function B(){localStorage.setItem("students",JSON.stringify(r)),console.log("Data saved")}function z(){const e=localStorage.getItem("students");e&&(r=JSON.parse(e),i(r),f(r,m),g(),console.log("Data loaded"))}window.addEventListener("beforeunload",B);window.addEventListener("load",z);const k=document.getElementById("themsv"),V=document.getElementById("locsv"),w=document.getElementById("deleteModal"),A=document.getElementById("editModal");k.addEventListener("click",function(e){e.target===this&&(v=!1,c.reset(),k.style.display="none")});V.addEventListener("click",function(e){e.target===this&&(V.style.display="none")});w.addEventListener("click",function(e){e.target===this&&(w.style.display="none")});A.addEventListener("click",function(e){e.target===this&&(v=!1,c.reset(),A.style.display="none")});const I=document.getElementById("editModal"),G=document.getElementById("editBtn"),Q=document.querySelector(".closeModalUpdate"),R=document.getElementById("huyBtnEdit");R.addEventListener("click",function(){v=!1,c.reset(),I.style.display="none"});Q.addEventListener("click",function(){v=!1,c.reset(),I.style.display="none"});G.addEventListener("click",function(){if(I.style.display="none",S){let e=r.findIndex(t=>t.MSSV===S.MSSV);r[e]=S,v=!1,console.log("Data updatedsdsdsdsdsdd")}B(),u=!1,d=[],y.reset(),i(r),f(r,m),g(),c.reset()});
