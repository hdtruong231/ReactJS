(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&l(v)}).observe(document,{childList:!0,subtree:!0});function n(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(o){if(o.ep)return;o.ep=!0;const d=n(o);fetch(o.href,d)}})();const u=document.getElementById("formAdd"),D=document.getElementById("addStudent"),q=document.getElementById("submit"),C=document.getElementById("textHeading");let B=!1,r=[];const m=10;let a=1;const $=document.getElementById("listPage"),O=document.getElementById("pages");function g(){a===1?(document.getElementById("prev").setAttribute("disabled",!0),document.getElementById("prev").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("prev").removeAttribute("disabled"),document.getElementById("prev").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.remove("bg-gray-300","text-gray-500"));let e=0;i===!0?e=Math.ceil(s.length/m):e=Math.ceil(r.length/m),a===e?(document.getElementById("next").setAttribute("disabled",!0),document.getElementById("next").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("next").removeAttribute("disabled"),document.getElementById("next").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.remove("bg-gray-300","text-gray-500"))}document.getElementById("prev").addEventListener("click",function(){a>1&&(a--,c(i===!0?s:r,a),document.querySelectorAll(".page").forEach(function(e){e.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),e.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${a}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${a}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&h(b))});document.getElementById("next").addEventListener("click",function(){let e=0;i===!0?e=Math.ceil(s.length/m):e=Math.ceil(r.length/m),a<e&&(a++,c(i===!0?s:r,a),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${a}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${a}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&h(b))});O.addEventListener("click",function(e){e.target.classList.contains("page")&&(a=parseInt(e.target.dataset.page),c(i===!0?s:r,a),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),e.target.classList.add("bg-blue-500","text-white","hover:bg-blue-700"),e.target.classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&h(b))});function P(e,t,n){const l=(n-1)*t,o=l+t;return e.slice(l,o)}function f(e,t){const n=Math.ceil(e.length/t);let l="";for(let o=1;o<=n;o++)l+=`<button class="page ${o===1?"bg-blue-500 hover:bg-blue-700 nfont-bold text-white":"bg-gray-300 hover:bg-gray-500 text-black"}  font-bold py-2 px-4 rounded" data-page="${o}">${o}</button>`;$.innerHTML=l}function c(e,t=1){let n=document.getElementById("listStudent"),l="";P(e,m,t).forEach(function(d){l+='<tr><td class="border border-gray-300 px-4 py-2">'+d.name+'</td><td class="border border-gray-300 px-4 py-2">'+d.MSSV+'</td><td class="border border-gray-300 px-4 py-2">'+d.email+'</td><td class="border border-gray-300 px-4 py-2">'+d.department.text+'</td><td class="border border-gray-300 px-4 py-2">'+d.gender.text+'</td><td class="border border-gray-300 px-4 py-2">'+d.birthdate+`</td><td class="border border-gray-300 px-4 py-2 text-center"><button class="editStudent bg-blue-500 hover:bg-blue-700 active:bg-blue-900 text-white font-bold py-2 px-4 rounded" data-mssv="${d.MSSV}">Sửa</button></td><td class="border border-gray-300 px-4 py-2"><button class="delStudent  bg-red-500 hover:bg-red-700 active:bg-red-900 text-white font-bold py-2 px-4 rounded" data-mssv="${d.MSSV}">Xóa</button></td></tr>`}),n.innerHTML=l}D.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="flex",q.textContent="Thêm",C.textContent="Thêm Sinh Viên",document.getElementById("MSSV").removeAttribute("readonly")});const p=document.getElementById("deleteModal"),N=document.getElementById("deleteBtn"),H=document.querySelector(".closeModalConfirm"),Y=document.getElementById("huyBtn");N.addEventListener("click",function(){r=r.filter(e=>e.MSSV!==p.dataset.mssv),S(),p.style.display="none",i=!1,s=[],y.reset(),c(r),f(r,m),g(),h(b)});Y.addEventListener("click",function(){p.style.display="none"});H.addEventListener("click",function(){p.style.display="none"});document.addEventListener("click",function(e){if(e.target.classList.contains("delStudent"))p.style.display="flex",p.dataset.mssv=e.target.dataset.mssv;else if(e.target.classList.contains("editStudent")){const t=e.target.dataset.mssv,n=r.find(l=>l.MSSV===t);if(n){const l=document.getElementById("themsv");l.style.display="flex",q.textContent="Cập nhật",C.textContent="Cập nhật Thông tin",document.getElementById("name").value=n.name,document.getElementById("MSSV").value=n.MSSV,document.getElementById("MSSV").setAttribute("readonly",!0),document.getElementById("email").value=n.email,document.getElementById("department").value=n.department.value,document.getElementById("gender").value=n.gender.value,document.getElementById("birthdate").value=n.birthdate,B=!0}}});let E=null;u.addEventListener("submit",function(e){e.preventDefault();let t={name:u.name.value.trim(),MSSV:u.MSSV.value.trim(),email:u.email.value.trim(),department:{value:u.department.value,text:u.department.options[u.department.selectedIndex].text},gender:{value:u.gender.value,text:u.gender.options[u.gender.selectedIndex].text},birthdate:u.birthdate.value};if(B===!1){for(let l=0;l<r.length;l++)if(r[l].MSSV===t.MSSV){alert("MSSV đã tồn tại");return}r.push(t),S(),i=!1,s=[],y.reset(),c(r),f(r,m),g(),u.reset()}else E=t,x.style.display="flex",B=!1;const n=document.getElementById("themsv");n.style.display="none",console.log(t)});const F=document.getElementById("search"),J=document.getElementById("searchBtn"),T=document.getElementById("clearSearch");T.addEventListener("click",function(){F.value="",i=!1,c(r),f(r,m),g()});J.addEventListener("click",function(){const e=F.value;if(e==="")i=!1,c(r),f(r,m),g();else{i=!0,s=r.filter(n=>n.name.toLowerCase().includes(e.toLowerCase()));let t=document.getElementById("listStudent");if(c(s),f(s,m),g(),s.length===0){let n='<tr><td class="border border-gray-300 px-4 py-2" colspan="8">Không tìm thấy sinh viên</td></tr>';t.innerHTML=n}}});function K(){let e=new Date().getFullYear(),t=document.getElementById("yearFilter");for(let n=e;n>=1980;n--){let l=document.createElement("option");l.value=n,l.text=n,t.appendChild(l)}}K();const j=document.getElementById("closeModal");j.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="none",u.reset()});const U=document.getElementById("closefil");U.addEventListener("click",function(){const e=document.getElementById("locsv");e.style.display="none",u.reset()});const X=document.getElementById("filStudent");X.addEventListener("click",function(){T.click();const e=document.getElementById("locsv"),t=y.yearFilter.value,n=y.gFilter.value,l=y.dFilter.value;c(t!==""||n!==""||l!==""?s:r),e.style.display="flex"});const y=document.getElementById("formFilter");let i=!1,s=[];y.addEventListener("submit",function(e){e.preventDefault();const t=y.yearFilter.value,n=y.gFilter.value,l=y.dFilter.value;s=r,i=!0,t!==""&&(s=s.filter(d=>d.birthdate.includes(t))),n!==""&&(s=s.filter(d=>d.gender.value===n)),l!==""&&(s=s.filter(d=>d.department.value===l)),c(s),f(s,m),a=1,g();const o=document.getElementById("locsv");o.style.display="none"});y.addEventListener("reset",function(){i=!1,c(r),f(r,m),a=1,g(),y.reset();const e=document.getElementById("locsv");e.style.display="none"});function L(e,t,n=!0){e.sort((l,o)=>{const d=M(l,t),v=M(o,t);return n?d.localeCompare(v):v.localeCompare(d)})}const I=document.getElementById("table");function M(e,t){switch(t){case 0:return e.name.trim();case 1:return e.MSSV.trim();case 2:return e.email.trim();case 3:return e.department.text.trim();case 4:return e.gender.text.trim();case 5:return e.birthdate.trim();default:return""}}let b=-1;function h(e){const t=document.getElementById("table"),n=Array.from(t.querySelectorAll("tr"));t.querySelectorAll("th").forEach(l=>{l.classList.remove("bg-blue-200")}),n.forEach(l=>{l.querySelectorAll("td").forEach(o=>{o.classList.remove("bg-blue-100")})}),t.querySelectorAll("th")[e].classList.add("bg-blue-200"),n.forEach(l=>{const o=l.querySelectorAll("td")[e];o&&o.classList.add("bg-blue-100")}),b=e}I.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{h(t)})});I.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{I.querySelectorAll(".ths").forEach(o=>{if(o!==e){o.classList.remove("asc");const d=o.querySelector("svg");d.style.transform="rotate(0deg)"}});const n=e.classList.contains("asc");L(i===!0?s:r,t,!n),c(i?s:r,1),f(i?s:r,m),a=1,g(),h(t),e.classList.toggle("asc",!n);const l=e.querySelector("svg");n?l.style.transform="rotate(180deg)":l.style.transform="rotate(0deg)"})});function S(){localStorage.setItem("students",JSON.stringify(r)),console.log("Data saved")}function z(){const e=localStorage.getItem("students");e&&(r=JSON.parse(e),c(r),f(r,m),g(),console.log("Data loaded"))}window.addEventListener("beforeunload",S);window.addEventListener("load",z);const k=document.getElementById("themsv"),V=document.getElementById("locsv"),w=document.getElementById("deleteModal"),A=document.getElementById("editModal");k.addEventListener("click",function(e){e.target===this&&(k.style.display="none")});V.addEventListener("click",function(e){e.target===this&&(V.style.display="none")});w.addEventListener("click",function(e){e.target===this&&(w.style.display="none")});A.addEventListener("click",function(e){e.target===this&&(A.style.display="none")});const x=document.getElementById("editModal"),G=document.getElementById("editBtn"),Q=document.querySelector(".closeModalUpdate"),R=document.getElementById("huyBtnEdit");R.addEventListener("click",function(){x.style.display="none"});Q.addEventListener("click",function(){x.style.display="none"});G.addEventListener("click",function(){if(x.style.display="none",E){let e=r.findIndex(t=>t.MSSV===E.MSSV);r[e]=E,console.log("Data updatedsdsdsdsdsdd")}S(),i=!1,s=[],y.reset(),c(r),f(r,m),g(),u.reset()});
