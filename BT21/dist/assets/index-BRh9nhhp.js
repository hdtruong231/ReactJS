(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&n(v)}).observe(document,{childList:!0,subtree:!0});function l(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=l(r);fetch(r.href,s)}})();const u=document.getElementById("formAdd"),C=document.getElementById("addStudent"),V=document.getElementById("submit"),k=document.getElementById("textHeading");let E=!1,o=[];const m=10;let d=1;const T=document.getElementById("listPage"),F=document.getElementById("pages");function g(){d===1?(document.getElementById("prev").setAttribute("disabled",!0),document.getElementById("prev").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("prev").removeAttribute("disabled"),document.getElementById("prev").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("prev").classList.remove("bg-gray-300","text-gray-500"));let e=0;c===!0?e=Math.ceil(a.length/m):e=Math.ceil(o.length/m),d===e?(document.getElementById("next").setAttribute("disabled",!0),document.getElementById("next").classList.remove("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.add("bg-gray-300","text-gray-500")):(document.getElementById("next").removeAttribute("disabled"),document.getElementById("next").classList.add("bg-blue-500","text-white","hover:bg-blue-700","font-bold"),document.getElementById("next").classList.remove("bg-gray-300","text-gray-500"))}document.getElementById("prev").addEventListener("click",function(){d>1&&(d--,i(c===!0?a:o,d),document.querySelectorAll(".page").forEach(function(e){e.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),e.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${d}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${d}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&p(b))});document.getElementById("next").addEventListener("click",function(){let e=0;c===!0?e=Math.ceil(a.length/m):e=Math.ceil(o.length/m),d<e&&(d++,i(c===!0?a:o,d),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${d}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${d}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&p(b))});F.addEventListener("click",function(e){e.target.classList.contains("page")&&(d=parseInt(e.target.dataset.page),i(c===!0?a:o,d),document.querySelectorAll(".page").forEach(function(t){t.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),t.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),e.target.classList.add("bg-blue-500","text-white","hover:bg-blue-700"),e.target.classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g(),b!=-1&&p(b))});function $(e,t,l){const n=(l-1)*t,r=n+t;return e.slice(n,r)}function y(e,t){const l=Math.ceil(e.length/t);let n="";for(let r=1;r<=l;r++)n+=`<button class="page ${r===1?"bg-blue-500 hover:bg-blue-700 nfont-bold text-white":"bg-gray-300 hover:bg-gray-500 text-black"}  font-bold py-2 px-4 rounded" data-page="${r}">${r}</button>`;T.innerHTML=n}function i(e,t=1){let l=document.getElementById("listStudent"),n="";$(e,m,t).forEach(function(s){n+='<tr><td class="border border-gray-300 px-4 py-2">'+s.name+'</td><td class="border border-gray-300 px-4 py-2">'+s.MSSV+'</td><td class="border border-gray-300 px-4 py-2">'+s.email+'</td><td class="border border-gray-300 px-4 py-2">'+s.department.text+'</td><td class="border border-gray-300 px-4 py-2">'+s.gender.text+'</td><td class="border border-gray-300 px-4 py-2">'+s.birthdate+`</td><td class="border border-gray-300 px-4 py-2 text-center"><button class="editStudent bg-blue-500 hover:bg-blue-700 active:bg-blue-900 text-white font-bold py-2 px-4 rounded" data-mssv="${s.MSSV}">Sửa</button></td><td class="border border-gray-300 px-4 py-2"><button class="delStudent  bg-red-500 hover:bg-red-700 active:bg-red-900 text-white font-bold py-2 px-4 rounded" data-mssv="${s.MSSV}">Xóa</button></td></tr>`}),l.innerHTML=n}C.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="flex",V.textContent="Thêm",k.textContent="Thêm Sinh Viên",document.getElementById("MSSV").removeAttribute("readonly")});const h=document.getElementById("deleteModal"),D=document.getElementById("deleteBtn"),O=document.querySelector(".closeModalConfirm"),P=document.getElementById("huyBtn");D.addEventListener("click",function(){o=o.filter(e=>e.MSSV!==h.dataset.mssv),x(),c=!1,a=[],f.reset(),i(o),y(o,m),g(),p(b),h.style.display="none"});P.addEventListener("click",function(){h.style.display="none"});O.addEventListener("click",function(){h.style.display="none"});document.addEventListener("click",function(e){if(e.target.classList.contains("delStudent"))h.style.display="flex",h.dataset.mssv=e.target.dataset.mssv;else if(e.target.classList.contains("editStudent")){const t=e.target.dataset.mssv,l=o.find(n=>n.MSSV===t);if(l){const n=document.getElementById("themsv");n.style.display="flex",V.textContent="Cập nhật",k.textContent="Cập nhật Thông tin",document.getElementById("name").value=l.name,document.getElementById("MSSV").value=l.MSSV,document.getElementById("MSSV").setAttribute("readonly",!0),document.getElementById("email").value=l.email,document.getElementById("department").value=l.department.value,document.getElementById("gender").value=l.gender.value,document.getElementById("birthdate").value=l.birthdate,E=!0}}});u.addEventListener("submit",function(e){let t={};if(e.preventDefault(),t={name:u.name.value.trim(),MSSV:u.MSSV.value.trim(),email:u.email.value.trim(),department:{value:u.department.value,text:u.department.options[u.department.selectedIndex].text},gender:{value:u.gender.value,text:u.gender.options[u.gender.selectedIndex].text},birthdate:u.birthdate.value},E===!1){for(let n=0;n<o.length;n++)if(o[n].MSSV===t.MSSV){alert("MSSV đã tồn tại");return}o.push(t)}else for(let n=0;n<o.length;n++)o[n].MSSV===t.MSSV&&(o[n]=t,E=!1);x(),c=!1,a=[],f.reset(),i(o),y(o,m),g(),u.reset();const l=document.getElementById("themsv");l.style.display="none",console.log(t)});const A=document.getElementById("search"),N=document.getElementById("searchBtn"),q=document.getElementById("clearSearch");q.addEventListener("click",function(){A.value="",c=!1,i(o),y(o,m),g()});N.addEventListener("click",function(){const e=A.value;if(e==="")c=!1,i(o),y(o,m),g();else{c=!0,a=o.filter(l=>l.name.toLowerCase().includes(e.toLowerCase()));let t=document.getElementById("listStudent");if(i(a),y(a,m),g(),a.length===0){let l='<tr><td class="border border-gray-300 px-4 py-2" colspan="8">Không tìm thấy sinh viên</td></tr>';t.innerHTML=l}}});function H(){let e=new Date().getFullYear(),t=document.getElementById("yearFilter");for(let l=e;l>=1980;l--){let n=document.createElement("option");n.value=l,n.text=l,t.appendChild(n)}}H();const Y=document.getElementById("closeModal");Y.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="none",u.reset()});const J=document.getElementById("closefil");J.addEventListener("click",function(){const e=document.getElementById("locsv");e.style.display="none",u.reset()});const K=document.getElementById("filStudent");K.addEventListener("click",function(){q.click();const e=document.getElementById("locsv");e.style.display="flex"});const f=document.getElementById("formFilter");let c=!1,a=[];f.addEventListener("submit",function(e){e.preventDefault();const t=f.yearFilter.value,l=f.gFilter.value,n=f.dFilter.value;a=o,c=!0,t!==""&&(a=a.filter(s=>s.birthdate.includes(t))),l!==""&&(a=a.filter(s=>s.gender.value===l)),n!==""&&(a=a.filter(s=>s.department.value===n)),i(a),y(a,m),d=1,g();const r=document.getElementById("locsv");r.style.display="none"});f.addEventListener("reset",function(){c=!1,i(o),y(o,m),d=1,g(),f.reset();const e=document.getElementById("locsv");e.style.display="none"});function I(e,t,l=!0){e.sort((n,r)=>{const s=L(n,t),v=L(r,t);return l?s.localeCompare(v):v.localeCompare(s)})}const S=document.getElementById("table");function L(e,t){switch(t){case 0:return e.name.trim();case 1:return e.MSSV.trim();case 2:return e.email.trim();case 3:return e.department.text.trim();case 4:return e.gender.text.trim();case 5:return e.birthdate.trim();default:return""}}let b=-1;function p(e){const t=document.getElementById("table"),l=Array.from(t.querySelectorAll("tr"));t.querySelectorAll("th").forEach(n=>{n.classList.remove("bg-blue-200")}),l.forEach(n=>{n.querySelectorAll("td").forEach(r=>{r.classList.remove("bg-blue-100")})}),t.querySelectorAll("th")[e].classList.add("bg-blue-200"),l.forEach(n=>{const r=n.querySelectorAll("td")[e];r&&r.classList.add("bg-blue-100")}),b=e}S.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{p(t)})});S.querySelectorAll(".ths").forEach((e,t)=>{e.addEventListener("click",()=>{S.querySelectorAll(".ths").forEach(r=>{if(r!==e){r.classList.remove("asc");const s=r.querySelector("svg");s.style.transform="rotate(0deg)"}});const l=e.classList.contains("asc");I(c===!0?a:o,t,!l),i(c?a:o,1),y(c?a:o,m),d=1,g(),p(t),e.classList.toggle("asc",!l);const n=e.querySelector("svg");l?n.style.transform="rotate(180deg)":n.style.transform="rotate(0deg)"})});function x(){localStorage.setItem("students",JSON.stringify(o)),console.log("Data saved")}function j(){const e=localStorage.getItem("students");e&&(o=JSON.parse(e),i(o),y(o,m),g(),console.log("Data loaded"))}window.addEventListener("beforeunload",x);window.addEventListener("load",j);const B=document.getElementById("themsv"),M=document.getElementById("locsv"),w=document.getElementById("deleteModal");B.addEventListener("click",function(e){e.target===this&&(B.style.display="none")});M.addEventListener("click",function(e){e.target===this&&(M.style.display="none")});w.addEventListener("click",function(e){e.target===this&&(w.style.display="none")});
