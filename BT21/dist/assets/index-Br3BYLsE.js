(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const v of r.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&t(v)}).observe(document,{childList:!0,subtree:!0});function l(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(o){if(o.ep)return;o.ep=!0;const r=l(o);fetch(o.href,r)}})();const c=document.getElementById("formAdd"),L=document.getElementById("addStudent"),I=document.getElementById("submit"),B=document.getElementById("textHeading");let h=!1,s=[];const u=2;let d=1;const M=document.getElementById("listPage"),w=document.getElementById("pages");function g(){d===1?(document.getElementById("prev").setAttribute("disabled",!0),document.getElementById("prev").classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),document.getElementById("prev").classList.add("bg-gray-300","text-black")):(document.getElementById("prev").removeAttribute("disabled"),document.getElementById("prev").classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.getElementById("prev").classList.remove("bg-gray-300","text-black"));let e=0;m===!0?e=Math.ceil(a.length/u):e=Math.ceil(s.length/u),d===e?(document.getElementById("next").setAttribute("disabled",!0),document.getElementById("next").classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),document.getElementById("next").classList.add("bg-gray-300","text-black")):(document.getElementById("next").removeAttribute("disabled"),document.getElementById("next").classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.getElementById("next").classList.remove("bg-gray-300","text-black"))}document.getElementById("prev").addEventListener("click",function(){d>1&&(d--,i(m===!0?a:s,d),document.querySelectorAll(".page").forEach(function(e){e.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),e.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${d}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${d}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g())});document.getElementById("next").addEventListener("click",function(){let e=0;m===!0?e=Math.ceil(a.length/u):e=Math.ceil(s.length/u),d<e&&(d++,i(m===!0?a:s,d),document.querySelectorAll(".page").forEach(function(n){n.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),n.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),document.querySelector(`.page[data-page="${d}"]`).classList.add("bg-blue-500","text-white","hover:bg-blue-700"),document.querySelector(`.page[data-page="${d}"]`).classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g())});w.addEventListener("click",function(e){e.target.classList.contains("page")&&(d=parseInt(e.target.dataset.page),i(m===!0?a:s,d),document.querySelectorAll(".page").forEach(function(n){n.classList.remove("bg-blue-500","text-white","hover:bg-blue-700"),n.classList.add("bg-gray-300","text-black","hover:bg-gray-500")}),e.target.classList.add("bg-blue-500","text-white","hover:bg-blue-700"),e.target.classList.remove("bg-gray-300","text-black","hover:bg-gray-500"),g())});function V(e,n,l){const t=(l-1)*n,o=t+n;return e.slice(t,o)}function y(e,n){const l=Math.ceil(e.length/n);let t="";for(let o=1;o<=l;o++)t+=`<button class="page ${o===1?"bg-blue-500 hover:bg-blue-700 nfont-bold text-white":"bg-gray-300 hover:bg-gray-500 text-black"}  font-bold py-2 px-4 rounded" data-page="${o}">${o}</button>`;M.innerHTML=t}function i(e,n=1){let l=document.getElementById("listStudent"),t="";V(e,u,n).forEach(function(r){t+='<tr><td class="border border-gray-300 px-4 py-2">'+r.name+'</td><td class="border border-gray-300 px-4 py-2">'+r.MSSV+'</td><td class="border border-gray-300 px-4 py-2">'+r.email+'</td><td class="border border-gray-300 px-4 py-2">'+r.department.text+'</td><td class="border border-gray-300 px-4 py-2">'+r.gender.text+'</td><td class="border border-gray-300 px-4 py-2">'+r.birthdate+`</td><td class="border border-gray-300 px-4 py-2"><button class="editStudent bg-blue-500 hover:bg-blue-700 active:bg-blue-900 text-white font-bold py-2 px-4 rounded" data-mssv="${r.MSSV}">Sửa</button></td><td class="border border-gray-300 px-4 py-2"><button class="delStudent  bg-red-500 hover:bg-red-700 active:bg-red-900 text-white font-bold py-2 px-4 rounded" data-mssv="${r.MSSV}">Xóa</button></td></tr>`}),l.innerHTML=t}L.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="flex",I.textContent="Thêm",B.textContent="Thêm Sinh Viên",document.getElementById("MSSV").removeAttribute("readonly")});const f=document.getElementById("deleteModal"),k=document.getElementById("deleteBtn"),A=document.querySelector(".closeModalConfirm"),C=document.getElementById("huyBtn");k.addEventListener("click",function(){s=s.filter(e=>e.MSSV!==f.dataset.mssv),E(),i(s),y(s,u),g(),f.style.display="none"});C.addEventListener("click",function(){f.style.display="none"});A.addEventListener("click",function(){f.style.display="none"});document.addEventListener("click",function(e){if(e.target.classList.contains("delStudent"))f.style.display="flex",f.dataset.mssv=e.target.dataset.mssv;else if(e.target.classList.contains("editStudent")){const n=e.target.dataset.mssv,l=s.find(t=>t.MSSV===n);if(l){const t=document.getElementById("themsv");t.style.display="flex",I.textContent="Cập nhật",B.textContent="Cập nhật Thông tin",document.getElementById("name").value=l.name,document.getElementById("MSSV").value=l.MSSV,document.getElementById("MSSV").setAttribute("readonly",!0),document.getElementById("email").value=l.email,document.getElementById("department").value=l.department.value,document.getElementById("gender").value=l.gender.value,document.getElementById("birthdate").value=l.birthdate,h=!0}}});c.addEventListener("submit",function(e){let n={};if(e.preventDefault(),n={name:c.name.value.trim(),MSSV:c.MSSV.value.trim(),email:c.email.value.trim(),department:{value:c.department.value,text:c.department.options[c.department.selectedIndex].text},gender:{value:c.gender.value,text:c.gender.options[c.gender.selectedIndex].text},birthdate:c.birthdate.value},h===!1){for(let t=0;t<s.length;t++)if(s[t].MSSV===n.MSSV){alert("MSSV đã tồn tại");return}s.push(n)}else for(let t=0;t<s.length;t++)s[t].MSSV===n.MSSV&&(s[t]=n,h=!1);E(),i(s),y(s,u),g(),c.reset();const l=document.getElementById("themsv");l.style.display="none",console.log(n)});const q=document.getElementById("search"),T=document.getElementById("searchBtn");T.addEventListener("click",function(){const e=q.value;if(e==="")m=!1,i(s),y(s,u),g();else{m=!0,a=s.filter(l=>l.name.toLowerCase().includes(e.toLowerCase()));let n=document.getElementById("listStudent");if(i(a),y(a,u),g(),a.length===0){let l='<tr><td class="border border-gray-300 px-4 py-2" colspan="8">Không tìm thấy sinh viên</td></tr>';n.innerHTML=l}}});function F(){let e=new Date().getFullYear(),n=document.getElementById("yearFilter");for(let l=e;l>=1980;l--){let t=document.createElement("option");t.value=l,t.text=l,n.appendChild(t)}}F();const $=document.getElementById("closeModal");$.addEventListener("click",function(){const e=document.getElementById("themsv");e.style.display="none",c.reset()});const O=document.getElementById("closefil");O.addEventListener("click",function(){const e=document.getElementById("locsv");e.style.display="none",c.reset()});const P=document.getElementById("filStudent");P.addEventListener("click",function(){const e=document.getElementById("locsv");e.style.display="flex"});const b=document.getElementById("formFilter");let m=!1,a=[];b.addEventListener("submit",function(e){e.preventDefault();const n=b.yearFilter.value,l=b.gFilter.value,t=b.dFilter.value;a=s,m=!0,n!==""&&(a=a.filter(r=>r.birthdate.includes(n))),l!==""&&(a=a.filter(r=>r.gender.value===l)),t!==""&&(a=a.filter(r=>r.department.value===t)),i(a),y(a,u),d=1,g();const o=document.getElementById("locsv");o.style.display="none"});b.addEventListener("reset",function(){m=!1,i(s),y(s,u),d=1,g(),b.reset();const e=document.getElementById("locsv");e.style.display="none"});function D(e,n,l=!0){const t=e.tBodies[0],o=Array.from(t.querySelectorAll("tr"));o.sort((r,v)=>{const x=r.querySelectorAll("td")[n].textContent.trim(),S=v.querySelectorAll("td")[n].textContent.trim();return l?x.localeCompare(S):S.localeCompare(x)}),o.forEach(r=>t.appendChild(r))}const p=document.getElementById("table");p.querySelectorAll(".ths").forEach((e,n)=>{e.addEventListener("click",()=>{p.querySelectorAll(".ths").forEach(o=>{if(o!==e){o.classList.remove("asc");const r=o.querySelector("svg");r.style.display="none"}});const l=e.classList.contains("asc");D(p,n,!l),e.classList.toggle("asc",!l);const t=e.querySelector("svg");t.style.display="block",l?t.style.transform="rotate(180deg)":t.style.transform="rotate(0deg)"})});function E(){localStorage.setItem("students",JSON.stringify(s)),console.log("Data saved")}function N(){const e=localStorage.getItem("students");e&&(s=JSON.parse(e),i(s),y(s,u),g(),console.log("Data loaded"))}window.addEventListener("beforeunload",E);window.addEventListener("load",N);
